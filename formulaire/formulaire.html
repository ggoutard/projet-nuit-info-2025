<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Formulaire de contact</title>
<style>
:root {
  --bg:#1f1f24;
  --panel:#2a2d32;
  --accent:#E95420;
  --accent-2:#77216F;
  --text:#e9eaec;
  --text-dim:#b9bcc3;
  --border:#00000040;
  --radius:12px;
  --shadow:0 10px 24px rgba(0,0,0,.35);
  --avertissement:#eb8334;
}
body {
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, Ubuntu, sans-serif;
  margin: 0;
  padding: 40px;
  overflow-x: hidden;
  position: relative;
}
h2 {
  text-align: center;
  color: var(--accent);
  position: relative;
  z-index: 10;
}
form {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 20px;
  max-width: 400px;
  margin: auto;
  display: flex;
  flex-direction: column;
  gap: 16px;
  position: relative;
  z-index: 10;
}
#autresChamps {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
label {
  font-weight: 600;
  color: var(--text-dim);
}
input, textarea {
  width: 100%;
  padding: 10px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: #1c1f24;
  color: var(--text);
  font-size: 14px;
  box-sizing: border-box;
}
input:focus, textarea:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}
button {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: var(--radius);
  font-size: 15px;
  font-weight: 700;
  color: #fff;
  background: linear-gradient(145deg, var(--accent), var(--accent-2));
  cursor: pointer;
  transition: transform .08s ease, background .3s ease;
}
button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,.6);
}
#messageSpecial {
  color: var(--accent);
  font-weight: bold;
  text-align: center;
  margin-top: 20px;
  display: none;
}
.gmail-warning {
  border: 2px solid var(--avertissement) !important;
}
#gmailMessage {
  color: var(--avertissement);
  font-size: 0.9em;
  display: none;
}
.confetti {
  position: fixed;
  width: 8px;
  height: 8px;
  top: -10px;
  animation: fall linear forwards;
  z-index: 1;
  border-radius: 2px;
  pointer-events: none;
}
.erreur {
  border: 2px solid red !important;
}
.message-erreur {
  color: red;
  font-size: 0.9em;
  margin-top: 4px;
  display: none;
}
/* Fond semi-transparent pour modal */
#captchaModal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}
/* Contenu du pop-up */
#captchaContent {
  background: var(--panel);
  padding: 20px;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  max-width: 400px;
  text-align: center;
  color: var(--text);
}
#captchaContent h3 {
  color: var(--accent);
  margin-bottom: 10px;
}
#captchaErreur {
  color: red;
  font-size: 1.5em;
  margin-top: 8px;
}
@keyframes fall {
  to {
    transform: translateY(100vh) rotate(360deg);
    opacity: 0;
  }
}
</style>
</head>
<body>
<h2>Formulaire de contact</h2>
<form id="contactForm">
  <label for="nom">Nom :</label>
  <input type="text" id="nom" name="nom" required>
  <div id="autresChamps">
    <label for="email">Adresse mail :</label>
    <input type="email" id="email" name="email" required>
    <div id="gmailMessage">La révolution commence par changer de boîte mail</div>
    <label for="sujet">Sujet :</label>
    <input type="text" id="sujet" name="sujet" required>
    <label for="message">Message :</label>
    <textarea id="message" name="message" rows="5" required></textarea>
    <div id="messageErreur" class="message-erreur"></div>
    <button type="submit" id="submitBtn">Envoyer</button>
  </div>
</form>
<div id="messageSpecial"></div>

<!-- Modal Captcha -->
<div id="captchaModal">
  <div id="captchaContent">
    <h3>Eh là, doucement ! Est-ce que t'es humain d'abord ?</h3>
    <p id="captchaQuestion"></p>
    <input type="text" id="captchaInput">
    <div id="captchaErreur"></div>
    <button id="captchaValider">Valider</button>
  </div>
</div>

  <div id="confirmationPage" style="display:none; text-align:center; margin-top:50px;">
  <h2>Félicitations pour ta patience et ta persévérance !</h2>
  <p>Pour te récompenser, voici comment accéder à notre jeu Snake : appuie sur Ctrl + Alt + S</p>
    <p>Amuse-toi bien ;)</p>
  <button id="retourForm">Retour au formulaire</button>
</div>


<script>
const nomsInterdits = {
  "tim cook": "Tu ne vas pas nous apprendre la recette du succès !",
  "mark zuckerberg": "On n’a pas besoin de ton réseau ici !",
  "sundar pichai": "Pas la peine de chercher, on a déjà trouvé !",
  "satya nadella": "Le cloud est déjà bien rempli !",
  "jeff bezos": "Désolé, la fusée est partie sans toi !"
};

const champNom = document.getElementById("nom");
const champEmail = document.getElementById("email");
const champSujet = document.getElementById("sujet");
const champMessage = document.getElementById("message");
const gmailMessage = document.getElementById("gmailMessage");
const autresChamps = document.getElementById("autresChamps");
const messageSpecial = document.getElementById("messageSpecial");
const btn = document.getElementById("submitBtn");
const messageErreur = document.getElementById("messageErreur");

  const textesRatés = [
  "Oula, c'était chaud !",
  "Raté !",
  "Trop rapide pour toi :P",
  "Essaie encore ;)",
  "Peut-être une prochaine fois !",
  "T'as essayé de remplir le formulaire ?",
  "Rien de mieux à faire que me courir derrière ?"
];
  
// Bouton qui s'enfuit + change de texte si champs incomplets
btn.addEventListener("mouseover", function() {
  const nom = champNom.value.trim();
  const email = champEmail.value.trim();
  const sujet = champSujet.value.trim();
  const message = champMessage.value.trim();

  if (!nom || !email || !sujet || !message) {
    const x = Math.floor(Math.random() * 600) - 300; 
    const y = Math.floor(Math.random() * 300) - 150; 
    btn.style.transform = `translate(${x}px, ${y}px)`;

    // Change le texte du bouton avec une phrase troll
    btn.textContent = textesRatés[Math.floor(Math.random() * textesRatés.length)];
  } else {
    btn.style.transform = "translate(0,0)";
    btn.textContent = "Envoyer"; // reset si tout est rempli
  }
});
  
  btn.addEventListener("click", function(e) {
  const nom = champNom.value.trim();
  const email = champEmail.value.trim();
  const sujet = champSujet.value.trim();
  const message = champMessage.value.trim();

  if (!nom || !email || !sujet || !message) {
    // Empêche l'envoi normal
    e.preventDefault();
    // Affiche le popup
    alert("Bien joué, t'as été plus rapide. Mais tu n'as toujours pas rempli tout le formulaire !");
  }
  // Sinon, la soumission normale se fera et le captcha s'ouvrira
});


let messageBloquant = false;

// Validation troll sur le champ message
champMessage.addEventListener("input", function() {
  const valeur = champMessage.value.trim().toLowerCase();
  const interdits = {
    "bonjour": "Tu n'as rien de plus original que \"Bonjour\" ?",
    "bonsoir": "Es-tu sûr que c'est l'heure de dire \"Bonsoir\" ? ",
    "au revoir": "Espèce de malpoli ! ",
    "merci": "Pourquoi tu nous remercies déjà ? On n'a pas encore répondu !",
    "hello world": "Tu t'es trompé de terminal...",
    "je": "Toi, toi, toi, toujours toi !
  };
  let message = "";
  messageBloquant = false; // reset
  for (const mot in interdits) {
    if (valeur.includes(mot)) {
      message = interdits[mot];
      messageBloquant = true; // bloque l'envoi
      break;
    }
  }
  if (message) {
    champMessage.classList.add("erreur");
    messageErreur.textContent = message;
    messageErreur.style.display = "block";
  } else {
    champMessage.classList.remove("erreur");
    messageErreur.textContent = "";
    messageErreur.style.display = "none";
  }
});

// Bouton qui s'enfuit si champs incomplets ou message bloquant
btn.addEventListener("mouseover", function() {
  const nom = champNom.value.trim();
  const email = champEmail.value.trim();
  const sujet = champSujet.value.trim();
  const message = champMessage.value.trim();

  if (!nom || !email || !sujet || !message || messageBloquant) {
    const x = Math.floor(Math.random() * 600) - 300; 
    const y = Math.floor(Math.random() * 300) - 150; 
    btn.style.transform = `translate(${x}px, ${y}px)`;
    // Change le texte du bouton avec une phrase troll
    btn.textContent = textesRatés[Math.floor(Math.random() * textesRatés.length)];
  } else {
    btn.style.transform = "translate(0,0)";
    btn.textContent = "Envoyer"; // reset si tout est rempli et pas bloquant
  }
});

// Empêche la soumission si champs incomplets ou message bloquant
btn.addEventListener("click", function(e) {
  const nom = champNom.value.trim();
  const email = champEmail.value.trim();
  const sujet = champSujet.value.trim();
  const message = champMessage.value.trim();

  if (!nom || !email || !sujet || !message || messageBloquant) {
    e.preventDefault(); // bloque l'envoi
    alert("Oups ! Vérifie ton formulaire, il y a des erreurs ou un message interdit !");
    return false;
  }
});


// Détection des noms interdits
champNom.addEventListener("input", function() {
  const valeur = champNom.value.trim().toLowerCase();
  let match = null;
  for (const nom in nomsInterdits) {
    const [prenom, nomFamille] = nom.split(" ");
    if (valeur.includes(prenom) && valeur.includes(nomFamille)) {
      match = nom;
      break;
    }
  }
if (match) {
  autresChamps.style.display = "none";
  messageSpecial.style.display = "block";
  messageSpecial.textContent = nomsInterdits[match];
} else {
  autresChamps.style.display = "flex"; 
  messageSpecial.style.display = "none";
}

});

// Détection Gmail
champEmail.addEventListener("input", function() {
  const valeur = champEmail.value.trim().toLowerCase();
  if (valeur.includes("@gmail")) {
    champEmail.classList.add("gmail-warning");
    gmailMessage.style.display = "block";
  } else {
    champEmail.classList.remove("gmail-warning");
    gmailMessage.style.display = "none";
  }
});

// Sujet perd le focus après chaque caractère
champSujet.addEventListener("input", function() {
  champSujet.blur();
});

// Konami Code -> confettis en continu
const konamiCode = [
  "ArrowUp","ArrowUp","ArrowDown","ArrowDown",
  "ArrowLeft","ArrowRight","ArrowLeft","ArrowRight",
  "b","a"
];
let position = 0;
let confettiInterval;
document.addEventListener("keydown", function(e) {
  if (e.key.toLowerCase() === konamiCode[position].toLowerCase()) {
    position++;
    if (position === konamiCode.length) {
      if (!confettiInterval) {
        confettiInterval = setInterval(lancerConfettis, 200);
      }
      position = 0;
    }
  } else {
    position = 0;
  }
});
function lancerConfettis() {
  for (let i = 0; i < 8; i++) {
    const confetti = document.createElement("div");
    confetti.className = "confetti";
    confetti.style.left = Math.random() * window.innerWidth + "px";
    confetti.style.backgroundColor = `hsl(${Math.random()*360},100%,50%)`;
    confetti.style.animationDuration = (Math.random()*3+2) + "s";
    document.body.appendChild(confetti);
    setTimeout(() => confetti.remove(), 5000);
  }
}

// Captcha modal
const form = document.getElementById("contactForm");
const modal = document.getElementById("captchaModal");
const captchaQuestionEl = document.querySelector("#captchaContent #captchaQuestion");
const captchaInputEl = document.querySelector("#captchaContent #captchaInput");
const captchaErreurEl = document.querySelector("#captchaContent #captchaErreur");
const captchaValiderBtn = document.getElementById("captchaValider");

const questions = [
  { q: "Combien font 1 + 1 ? (Indice : ce n’est pas 2)", a: "3" },
  { q: "Écris le mot 'patate' à l’envers", a: "etatap" },
  { q: "Quelle est la capitale de la Lune ?", a: "cratère" },
  { q: "Combien de côtés a un triangle carré ?", a: "7" },
  { q: "Tape le cri du lama (indice : gnagnagna)", a: "gnagnagna" },
  { q: "Quelle est la couleur du vent ?", a: "transparent" },
  { q: "Écris 'Banane' mais avec un z à la place du B", a: "zanane" }
];
let currentCaptcha = null;

form.addEventListener("submit", function(e) {
  e.preventDefault();
  currentCaptcha = questions[Math.floor(Math.random() * questions.length)];
  captchaQuestionEl.textContent = currentCaptcha.q;
  captchaInputEl.value = "";
  captchaErreurEl.textContent = "";
  modal.style.display = "flex";
  captchaInputEl.focus();
});

const confirmationPage = document.getElementById("confirmationPage");
const retourFormBtn = document.getElementById("retourForm");

captchaValiderBtn.addEventListener("click", function() {
  if (captchaInputEl.value.trim() === currentCaptcha.a) {
    modal.style.display = "none";
    form.style.display = "none";        // cache le formulaire
    confirmationPage.style.display = "block"; // montre la page de confirmation
  } else {
    captchaErreurEl.textContent = "On savait que tu étais un robot !";
  }
});

// Option pour revenir au formulaire
retourFormBtn.addEventListener("click", function() {
  confirmationPage.style.display = "none";
  form.style.display = "flex";
  form.reset();  // réinitialise les champs
});

  // --- Nettoyage quand le formulaire est réinitialisé (form.reset())
form.addEventListener('reset', function() {
  // retire l'avertissement Gmail visuel
  champEmail.classList.remove('gmail-warning');
  gmailMessage.style.display = 'none';

  // retire l'erreur message si présente
  champMessage.classList.remove('erreur');
  messageErreur.textContent = '';
  messageErreur.style.display = 'none';

  // reset du drapeau bloquant
  messageBloquant = false;

  // reset du bouton pour qu'il reste en place et avec le texte correct
  btn.style.transform = 'translate(0,0)';
  btn.textContent = 'Envoyer';
});

// --- Amélioration du bouton "Retour au formulaire"
retourFormBtn.addEventListener("click", function() {
  confirmationPage.style.display = "none";
  form.style.display = "flex";
  form.reset();  // réinitialise les champs (déclenchera l'écouteur 'reset' ci-dessus)

  // S'assurer en plus que l'UI est propre (double sécurité)
  champEmail.classList.remove('gmail-warning');
  gmailMessage.style.display = 'none';
  champMessage.classList.remove('erreur');
  messageErreur.textContent = '';
  messageErreur.style.display = 'none';
  messageBloquant = false;
  btn.style.transform = 'translate(0,0)';
  btn.textContent = 'Envoyer';
});



modal.addEventListener("click", function(e) {
  if (e.target === modal) {
    modal.style.display = "none";
  }
});

  if (captchaInputEl.value.trim() === currentCaptcha.a) {
  modal.style.display = "none";
  form.submit();
} else {
  captchaErreurEl.textContent = "On savait que tu étais un robot !";
}

</script>
</body>
</html>
